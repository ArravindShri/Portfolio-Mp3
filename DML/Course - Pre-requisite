 
WITH Prerequisite AS (
	SELECT 
        course_id,
        course_name,
        category,
        prerequisite_course_id,
        1 as level
	FROM courses 
    -- Important: Only start with courses that actually have a prerequisite
    WHERE prerequisite_course_id IS NOT NULL 
UNION ALL
    SELECT
        c.course_id,
        c.course_name,
        c.category,
        c.prerequisite_course_id,
        p.level + 1
	FROM Prerequisite p
	JOIN courses c
	ON p.prerequisite_course_id = c.course_id 
)
SELECT
	level,
	course_id,
	course_name,
	category,
	prerequisite_course_id
FROM Prerequisite
-- Corrected the typo here:
WHERE prerequisite_course_id IS NOT NULL 
ORDER BY course_id, level 

Stored as view as well. 
